@model DSRCManagementSystem.Models.Email
@{
  
    Layout = null;
}
<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>ProjectMeeting</title>
    @*<link href="../../Content/Template/js/jquery-ui/css/no-theme/jquery-ui-1.10.3.custom.min.css"
        rel="stylesheet" type="text/css"    />*@
    <link href="../../Content/Template/css/font-icons/entypo/css/entypo.css" rel="stylesheet"
        type="text/css" />
    <link href="../../Content/Template/css/font-icons/entypo/css/animation.css" rel="stylesheet"
        type="text/css" />
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Noto+Sans:400,700,400italic"
        id="style-resource-4" />
    @*<link href="../../Content/Template/css/neon.css" rel="stylesheet" type="text/css" />*@
    <link href="../../Content/Template/css/custom.css" rel="stylesheet" type="text/css" />
    @*<script src="../../Content/Plugins/bootstrap-datetimepicker/js/en-gb.js" type="text/javascript"></script>*@
    <script src="../../Content/Plugins/bootstrap-datetimepicker/js/moment.js" type="text/javascript"></script>
    @*   <script src="../../Content/Plugins/bootstrap-datetimepicker/js/bootstrap-datepicker.js"
        type="text/javascript"></script>*@ @*    <link href="../../Content/Plugins/bootstrap-datetimepicker/css/bootstrap-datepicker.css"
        rel="stylesheet" type="text/css" />*@
    <script src="../../Content/Plugins/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js"
        type="text/javascript"></script>
    @*<link href="../../Content/Plugins/bootstrap-datetimepicker/css/bootstrap-datetimepicker.min.css"
        rel="stylesheet" type="text/css"    />*@


<link href="../../Content/Template/js/jquery-ui/css/no-theme/jquery-ui-1.10.3.custom.min.css"
        rel="stylesheet" type="text/css" />
    <link href="../../Content/Template/css/font-icons/entypo/css/entypo.css" rel="stylesheet"
        type="text/css" />
    <link href="../../Content/Template/css/font-icons/entypo/css/animation.css" rel="stylesheet"
        type="text/css" />
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Noto+Sans:400,700,400italic"
        id="style-resource-4" />
    <link href="../../Content/Template/css/custom.css" rel="stylesheet" type="text/css" />
    <script src="../../Content/Plugins/bootstrap-datetimepicker/js/moment.js" type="text/javascript"></script>
    <script src="../../Content/Plugins/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js"
        type="text/javascript"></script>
    <link href="../../Content/Plugins/bootstrap-datetimepicker/css/bootstrap-datetimepicker.min.css"
        rel="stylesheet" type="text/css" />
    <script src="../../Content/Template/js/select2/select2.min.js" type="text/javascript"></script>
    <script src="../../Content/JS/ToasterAlert.js" type="text/javascript"></script>
    <script src="http://jsfiddle.net/laelitenetwork/puJ6G/" type="text/javascript"></script>
    <script src="../../Completion/multiselect.min.js" type="text/javascript"></script>
   
    <script src="../../Completion/multiselect.js" type="text/javascript"></script>
    <style>
        textarea {
            resize: none;
        }
    </style>


</head>

    <style>
     .dropdown-menu {
    background-color:white;
}
        </style>


<body>
    <div class="modal-content">
        <div class="modal-header" style="background-color: #f0f0f1;">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                ×</button>
            <h4 class="modal-title">Add New Email Purpose</h4>
        </div>
        <div class="modal-body">
            
            @using (Html.BeginForm("AddNew", "AdministrationSetup", FormMethod.Post))
            {
                <div class="row">
                    <div class="col-md-12" style="text-align: right">
                        @Html.Label("*", new { @style = "color:#FF0000" }) Required field(s)
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            @Html.Label("Email Purpose", new { @class = "control-label" })
                            @Html.Label("*", new { @style = "color:#FF0000" })
                            @Html.DropDownList("Id3", ViewBag.Purpose as SelectList, "--Select--", new { @id = "Purpose", @class = "form-control" })
                            <span id="span_ID6" style="color: Red;"></span>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            @Html.Label("To", new { @class = "control-label" })
                            @Html.Label("*", new { @style = "color:#FF0000" })
                            @Html.DropDownList("Id", ViewBag.Email as MultiSelectList, new { @id = "To", @class = "form-control", @multiple = "multiple" })
                            <span id="span_ID7" style="color: Red;"></span>
                        </div>
                    </div>
                </div>
                 
                 
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            @Html.Label("CC", new { @class = "control-label" })
                            @Html.Label("*", new { @style = "color:#FF0000" })
                            @Html.DropDownList("Id", ViewBag.Email as MultiSelectList, new { @id = "CC", @class = "form-control", @multiple = "multiple" })
                            <span id="span_ID8" style="color: Red;"></span>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            @Html.Label("BCC", new { @class = "control-label" })
                            @Html.DropDownList("Id", ViewBag.Email as MultiSelectList, new { @id = "BCC", @class = "form-control", @multiple = "multiple" })
                            <span id="span_ID9" style="color: Red;"></span>
                        </div>
                    </div>
                </div>



                
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            @Html.Label("Subject", new { @class = "control-label" })
                            @Html.Label("*", new { @style = "color:#FF0000" })
                            @Html.TextBoxFor(x => x.Subject, new { @id = "Subject", @name = "Subject", @class = "form-control", @autocomplete = "off" })
                            <span id="span_ID10" style="color: Red;"></span>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            @Html.Label("Template", new { @class = "control-label" })
                            @Html.Label("*", new { @style = "color:#FF0000" })
                            @Html.TextBoxFor(x => x.Template, new { @id = "Template", @name = "Template", @class = "form-control", @autocomplete = "off", @disabled = "disabled" })
                            <span id="span_ID11" style="color: Red;"></span>
                        </div>
                    </div>
                </div>
                
 
                <div class="row">
                  <div class="col-md-6">
                        <div class="form-group" style="width: 250px; padding-top: 5px;">
                            @Html.Label("Email Category", new { @class = "control-label" })
                            @Html.Label("*", new { @style = "color:#FF0000" })
                            @Html.DropDownList("Id4", ViewBag.Emailcategory as SelectList, "--Select--", new
                       {
                           @id = "Id4",
                           @class = "form-control",
                           @name = "Template"
                       })
                            <span id="span_ID13" style="color: Red;"></span>
                        </div>
                    </div>
                </div>        
                
                
                                                              
            }
        </div>

        <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">
                Cancel
            </button>
            <button type="button" id="btnAdd" class="btn btn-info" onclick='AddNewMeeting()'>
                Save
            </button>
        </div>

    </div>
    <div class="modal fade in" id="portlet-config1" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
        aria-hidden="true">
        <div class="modal-dialog">
            <div class="tools">
                <div id="PartialSection">
                    <div id="LoaderContent" style="height: 100%;">
                        <img src="../../Content/Template/images/finalloader.GIF" style="margin-left: 43%; margin-top: 40%;" />
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="../../Content/Template/js/jquery.dataTables.min.js" type="text/javascript"></script>
    <script src="../../Content/Template/js/dataTables.bootstrap.js" type="text/javascript"></script>
    <script src="../../Content/Template/js/select2/select2.min.js" type="text/javascript"></script>
    <script src="../../Content/JS/ToasterAlert.js" type="text/javascript"></script>
    <script type="text/javascript">

        
        $(function () {

            $(".modal-body select").select2({
                minimumResultsForSearch: -1

            });
            $("#Purpose").select2();
            $("#Id4").select2();

        });


        $("#Purpose").change(function () {
            var u = $("#Purpose").find("option:selected").val();

            $.ajax({
                url: "../../AdministrationSetup/Value",
                type: "GET",
                cache: false,
                data: { value: u },
                success: function (result) {
                    $("#Template").val(result.Name);
                    var u = $("#Purpose :selected").text();
                    if (u == "New User" || u == "Reset Password" || u == "Forgot Password" || u == "Birthday Remainder" || u == "Leave Request Approved" || u == "Leave Request Rejected" || u == "Leave Request" || u == "Completion" || u == "Sendhwsw Request" || u == "HwSw Request Approved" || u == "Send hwsw Request_Stage2" || u == "HwSw Request Approved Stage2" || u == "HwSw Request AssignTo" || u == "HwSw Request Rejected" || u == "HwSw Request RejectedStage2" || u == "Nomination Confirmation" || u == "Training Schedule Change Notification" || u == "Training Schedule Cancelled" || u == "Apply OnDuty" || u == "Approve OnDuty" || u == "Reject OnDuty" || u == "Project Status") {
                        $("#To").attr('disabled', true);
                        $("#CC").attr('disabled', true);
                        $("#BCC").attr('disabled', true);
                    }
                    else if (u == "Assign Project" || u == "Assign Project Delete") {
                        $("#To").attr('disabled', true);
                        $("#CC").attr('disabled', false);
                        $("#BCC").attr('disabled', false);
                    }
                    else {
                        $("#To").attr('disabled', false);
                        $("#CC").attr('disabled', false);
                        $("#BCC").attr('disabled', false);
                    }
                }

            });
        });




        function AddNewMeeting() {

            var ec = $("#Id4").find("option:selected").prop("text");
            var SubjectName = $("#Subject").val();

            var SubjectNametrim = SubjectName.replace(/\s/g, "").length;

            if ($("#Purpose :selected").text() != "New User" && $("#Purpose :selected").text() != "Reset Password" && $("#Purpose :selected").text() != "Forgot Password" && $("#Purpose :selected").text() != "Birthday Remainder" && $("#Purpose :selected").text() != "Leave Request Approved" && $("#Purpose :selected").text() != "Leave Request Rejected" && $("#Purpose :selected").text() != "Leave Request" && $("#Purpose :selected").text() != "Completion" && $("#Purpose :selected").text() != "Send hwsw Request" && $("#Purpose :selected").text() != "HwSw Request Approved" && $("#Purpose :selected").text() != "Sendhwsw Request_Stage2" && $("#Purpose :selected").text() != "HwSw Request Approved Stage2" && $("#Purpose :selected").text() != "HwSw Request AssignTo" && $("#Purpose :selected").text() != "HwSw Request Rejected" && $("#Purpose :selected").text() != "HwSw Request Rejected Stage2" && $("#Purpose :selected").text() != "Nomination Confirmation" && $("#Purpose :selected").text() != "Training Schedule Change Notification" && $("#Purpose :selected").text() != "Training Schedule Cancelled" && $("#Purpose :selected").text() != "Apply OnDuty" && $("#Purpose :selected").text() != "Approve OnDuty" && $("#Purpose :selected").text() != "Reject OnDuty" && $("#Purpose :selected").text() != "Project Status" && $("#Purpose :selected").text() != "Assign Project" && $("#Purpose :selected").text() != "Assign Project Delete") {
                if (document.getElementById('Purpose').value == 0 || $("#Id4 :selected").text() == "--Select--" || document.getElementById('To').value == '' || document.getElementById('CC').value == '' || SubjectNametrim == '' || document.getElementById('Template').value == '') {

                    if (document.getElementById('Purpose').value == '') {
                        document.getElementById("span_ID6").innerHTML = "Please Enter The Email Purpose";
                    }
                    else {
                        document.getElementById("span_ID6").innerHTML = "";
                    }
                    if ($("#Id4 :selected").text() == "--Select--") {
                        document.getElementById("span_ID13").innerHTML = "Please Select Email Category";
                    }
                    else {
                        document.getElementById("span_ID13").innerHTML = "";
                    }
                    if (document.getElementById('To').value == '') {
                        if ($("#Purpose :selected").text() != "New User") {
                            document.getElementById("span_ID7").innerHTML = "Please Enter The To Email  ";
                        }
                    }
                    else {
                        document.getElementById("span_ID7").innerHTML = "";

                    }
                    if (document.getElementById('CC').value == '') {
                        if ($("#Purpose :selected").text() != "New User") {
                            document.getElementById("span_ID8").innerHTML = "Please Enter The CC Email  ";
                        }
                    }
                    else {
                        document.getElementById("span_ID8").innerHTML = "";

                    }

                    if (SubjectNametrim == '') {
                        document.getElementById("span_ID10").innerHTML = "Please Enter The Subject";
                    }
                    else {
                        document.getElementById("span_ID10").innerHTML = "";
                    }

                    if (document.getElementById('Template').value == '') {
                        document.getElementById("span_ID11").innerHTML = " Please Enter The Template";
                    }
                    else {
                        document.getElementById("span_ID11").innerHTML = "";
                    }
                    //if ($("#Emailcategory :selected").text() == "--Select--") {
                    //    document.getElementById("span_ID13").innerHTML = "Please Select Email Category";
                    //}

                    //else {
                    //    document.getElementById("span_ID13").innerHTML = "";
                    //}

                    //if ($("#Emailcategory").find("option:selected").prop("text") == '--select--') {
                    //    document.getElementById("span_ID12").innerHTML = " Please Select Email Category";
                    //}
                    //else {
                    //    document.getElementById("span_ID12").innerHTML = "";
                    //}

                }
                else {
                    $('#portlet-config1').appendTo("body").modal({ backdrop: 'static', keyboard: false });
                    var values =
                           {
                               "Purpose": $("#Purpose").find("option:selected").text(),
                               "To": $("#To").val() == null ? "" : $("#To").val().toString(),
                               "CC": $("#CC").val() == null ? "" : $("#CC").val().toString(),
                               "BCC": $("#BCC").val() == null ? "" : $("#BCC").val().toString(),
                               "Subject": $("#Subject").val(),
                               "Template": $("#Template").val(),
                               "EmailCategoryName": $("#Id4").find("option:selected").prop("text")
                           }
                    var opts =
                       {
                           "closeButton": true,
                           "debug": false,
                           "positionClass": "toast-top-right",
                           "toastClass": "White",
                           "onclick": null,
                           "showDuration": "300",
                           "hideDuration": "1000",
                           "timeOut": "2000",
                           "extendedTimeOut": "1000",
                           "showEasing": "swing",
                           "hideEasing": "linear",
                           "showMethod": "fadeIn",
                           "hideMethod": "fadeOut"
                       }

                    $.ajax({
                        url: "../../AdministrationSetup/AddNew/",
                        type: 'POST',
                        cache: false,
                        data: values,
                        traditional: true,
                        global: false,
                        success: function (result) {
                            if (result.Result === "Success") {

                                $("#portlet-config").modal('hide');
                                toastr.success("Email purpose added successfully", opts);
                                setTimeout(function () { location.reload(); }, 1000);

                            }

                            if (result.Result === "Already") {

                                $("#portlet-config").modal('hide');
                                toastr.warning("Email purpose already exist", opts);
                                //setTimeout(function () { location.reload(); }, 1000);

                            }

                        }

                    });
                }


            }

            else if ($("#Purpose :selected").text() == "Assign Project" || $("#Purpose :selected").text() == "Assign Project Delete") {
                if (document.getElementById('Purpose').value == 0 || document.getElementById('CC').value == '' || document.getElementById('Subject').value == '' || document.getElementById('Template').value == '' || ($("#Id4 :selected").text() == "--Select--")) {

                    if (document.getElementById('Purpose').value == '') {
                        document.getElementById("span_ID6").innerHTML = "Please Enter The Email Purpose2";
                    }
                    else {
                        document.getElementById("span_ID6").innerHTML = "";
                    }

                    if (document.getElementById('CC').value == '') {
                        if ($("#Purpose :selected").text() != "New User") {
                            document.getElementById("span_ID8").innerHTML = "Please Enter The CC Email  ";
                        }
                    }
                    else {
                        document.getElementById("span_ID8").innerHTML = "";

                    }

                    if (document.getElementById('Subject').value == '') {
                        document.getElementById("span_ID10").innerHTML = "Please Enter The Subject";
                    }
                    else {
                        document.getElementById("span_ID10").innerHTML = "";
                    }

                    if (document.getElementById('Template').value == '') {
                        document.getElementById("span_ID11").innerHTML = " Please Enter The Template";
                    }
                    else {
                        document.getElementById("span_ID11").innerHTML = "";
                    }
                    if ($("#Id4 :selected").text() == "--Select--") {
                        document.getElementById("span_ID13").innerHTML = "Please Select Email Category";
                    }
                    else {
                        document.getElementById("span_ID13").innerHTML = "";
                    }

                }
                else {
                    var values =
                           {
                               "Purpose": $("#Purpose").find("option:selected").text(),
                               "To": $("#To").val() == null ? "" : $("#To").val().toString(),
                               "CC": $("#CC").val() == null ? "" : $("#CC").val().toString(),
                               "BCC": $("#BCC").val() == null ? "" : $("#BCC").val().toString(),
                               "Subject": $("#Subject").val(),
                               "Template": $("#Template").val(),
                               "EmailCategoryName": $("#Id4").find("option:selected").prop("text")


                           }
                    var opts =
                       {
                           "closeButton": true,
                           "debug": false,
                           "positionClass": "toast-top-right",
                           "toastClass": "White",
                           "onclick": null,
                           "showDuration": "300",
                           "hideDuration": "1000",
                           "timeOut": "2000",
                           "extendedTimeOut": "1000",
                           "showEasing": "swing",
                           "hideEasing": "linear",
                           "showMethod": "fadeIn",
                           "hideMethod": "fadeOut"
                       }

                    $.ajax({
                        url: "../../AdministrationSetup/AddNew/",
                        type: 'POST',
                        cache: false,
                        data: values,
                        traditional: true,
                        global: false,
                        success: function (result) {

                            if (result.Result === "Success") {


                                toastr.success("Email purpose added successfully", opts);
                                setTimeout(function () { location.reload(); }, 1000);

                            }

                            if (result.Result === "Already") {


                                toastr.warning("Email purpose already exist", opts);
                                //setTimeout(function () { location.reload(); }, 1000);

                            }

                        }

                    });
                }
            }

            else {

                if (document.getElementById('Purpose').value == 0 || document.getElementById('Subject').value == '' || document.getElementById('Template').value == '' || ($("#Id4 :selected").text() == "--Select--")) {
                    if (document.getElementById('Purpose').value == '') {
                        document.getElementById("span_ID6").innerHTML = "Please Enter The Email Purpose3";
                    }
                    else {
                        document.getElementById("span_ID6").innerHTML = "";
                    }
                    if (document.getElementById('Subject').value == '') {
                        document.getElementById("span_ID10").innerHTML = "Please Enter The Subject";
                    }
                    else {
                        document.getElementById("span_ID10").innerHTML = "";
                    }

                    if (document.getElementById('Template').value == '') {
                        document.getElementById("span_ID11").innerHTML = " Please Enter The Template";
                    }
                    else {
                        document.getElementById("span_ID11").innerHTML = "";
                    }
                    if ($("#Id4 :selected").text() == "--Select--") {
                        document.getElementById("span_ID13").innerHTML = "Please Select Email Category";
                    }
                    else {
                        document.getElementById("span_ID13").innerHTML = "";
                    }


                }
                else {
                    var values =
                           {
                               "Purpose": $("#Purpose").find("option:selected").text(),
                               "To": $("#To").val() == null ? "" : $("#To").val().toString(),
                               "CC": $("#CC").val() == null ? "" : $("#CC").val().toString(),
                               "BCC": $("#BCC").val() == null ? "" : $("#BCC").val().toString(),
                               "Subject": $("#Subject").val(),
                               "Template": $("#Template").val(),
                               "EmailCategoryName": $("#Id4").find("option:selected").prop("text")


                           }
                    var opts =
                       {
                           "closeButton": true,
                           "debug": false,
                           "positionClass": "toast-top-right",
                           "toastClass": "White",
                           "onclick": null,
                           "showDuration": "300",
                           "hideDuration": "1000",
                           "timeOut": "2000",
                           "extendedTimeOut": "1000",
                           "showEasing": "swing",
                           "hideEasing": "linear",
                           "showMethod": "fadeIn",
                           "hideMethod": "fadeOut"
                       }

                    $.ajax({
                        url: "../../AdministrationSetup/AddNew/",
                        type: 'POST',
                        cache: false,
                        data: values,
                        traditional: true,
                        global: false,
                        success: function (result) {
                            if (result.Result === "Success") {


                                toastr.success("Email purpose added successfully", opts);
                                setTimeout(function () { location.reload(); }, 1000);

                            }

                            if (result.Result === "Already") {


                                toastr.warning("Email purpose already exist", opts);
                                //setTimeout(function () { location.reload(); }, 1000);

                            }

                        }

                    });

                }
            }

        }

    </script>
</body>
</html>
