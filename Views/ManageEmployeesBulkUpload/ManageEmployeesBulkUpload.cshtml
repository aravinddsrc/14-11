@model DSRCManagementSystem.Models.ManageEmployeesBulkUpload

@{
    ViewBag.Title = "Manage Employees Bulk Upload";
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
}


  <link href="../../Content/Template/js/select2/select2-bootstrap.css" rel="stylesheet"
    type="text/css" />
<link href="../../Content/Template/js/select2/select2.css" rel="stylesheet" type="text/css" />
<script src="../../Content/Template/js/select2/select2.min.js" type="text/javascript"></script>
 <script src="../../Content/Template/js/toastr.js" type="text/javascript"></script>

    <style>
      .dropdown-menu {
    background-color: white;
}   
        </style> 

@{
    int SNO = 1;
    DSRCManagementSystem.DSRCManagementSystemEntities1 db = new DSRCManagementSystem.DSRCManagementSystemEntities1();
    var branchcnt = db.Master_Branches.ToList().Count;
    var branchId = db.Master_Branches.ToList();
}

@*<ol class="breadcrumb bc-3">
    <li>
        <a href="@Url.Action("ManageUsers", "Users")">
            <i class="fa-home1"></i>Employee Management
        </a>
    </li>
    <li class="active"><strong>Manage Employees Bulk Upload</strong> </li>
</ol>*@
    <p>
        <a href="@Url.Action("ManageUsers","Users")"style="color:black ">
            Manage Employees
        </a>
          &#160;<img src="~/Images/righ-arrow.png" />&#160;
        <b>Manage Employees Bulk Upload</b>
    </p>
    <br />
<div class="row">
    <div class="col-md-12">
        <div class="panel panel-default panel-shadow" data-collapsed="0">

            <div class="panel-heading">
                <div class="panel-title" color="White">
                    Manage Employees Bulk Upload
                </div>
            </div>
           
            <div class="panel-body">
                @using (Html.BeginForm("ManageEmployeesBulkUpload", "ManageEmployeesBulkUpload", FormMethod.Post ,new { @id = "BulkUpload", @class = "form-horizontal form-groups-bordered", @enctype = "multipart/form-data" }))
                { 
                   <div class="row">
       
            <div class="col-md-12" style="text-align: right">
                @Html.Label("*", new { @style = "color:#FF0000" }) Required field(s)
            </div>
        </div>
        <div class="form-group">
          <div class="col-sm-2">
            </div>
     
        <div class="row">

            <div class="col-sm-2">
                @Html.Label("Excel File", new { @class = "control-label" })                    
                @Html.Label("  *", new { @style = "color:red;font-weight:bold;" })
            </div>

            <div class="col-sm-4">
               <input type="file" name="excelFile" id="file" accept=".xls,.xlsx" style="width: 100%;" />
             
            </div>
          </div>
        </div>
   
        <div class="form-group">
            <div class="col-sm-2">
            </div>
            <div class="col-sm-2">
                <label class="control-label">
                    Sample File</label>
            </div>
            <div class="col-sm-4">
                <a  href="~/SampleAttendanceFile/Manage Employee Sample.xls">
                    <input type="button" value="Sample File Format" /></a>
              
            </div>
            <div class="col-sm-2">
                 <button type="submit" id="IDUpload" class="btn btn-info" >Upload</button>  

            </div>
        </div>

                 
                }
                @if (Model.ErrorSuccessMessage != null)
    {

        if (Model.ErrorSuccessMessage.Contains("Please Enter Mandatory Column"))
        {
        <script type="text/javascript">
            toastr.warning("Please enter Mandatory Column");
        </script>
        }
        else if (Model.ErrorSuccessMessage == "Please upload the excel file.")
        {
         <script type="text/javascript">
             toastr.warning("Please upload the excel file.");
        </script>
        }
        else if (Model.ErrorSuccessMessage == "Please upload excel files only.")
        {
         <script type="text/javascript">
             toastr.warning("Please upload excel files only.");
        </script>
        }
        else if (Model.ErrorSuccessMessage == "Enter a Valid Phone Number")
        {
         <script type="text/javascript">
             toastr.warning("Enter a Valid Phone Number");
        </script>
        }
        else if (Model.ErrorSuccessMessage == "Enter a Valid Email Address")
        {
         <script type="text/javascript">
             toastr.warning("Enter a Valid Email Address.");
        </script>
        }
         else if (Model.ErrorSuccessMessage.Contains("Error"))
        {
        <script type="text/javascript">
            toastr.warning("Error: The uploaded document does not contain the valid data");
        </script>
        }
        else if (Model.ErrorSuccessMessage.Contains("Email Address is already Available"))
        {
        <script type="text/javascript">
            toastr.warning("Email Address is Already Available");
        </script>
        }
        
        else
        {
        <script type="text/javascript">
            toastr.success("Excel file uploaded successfully");
          
        </script>
        
        }
       
        }     
               
            </div>

        </div>
    </div>
</div>
    
<div class="modal fade in" id="portlet-config" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
        aria-hidden="true">
        <div class="modal-dialog">
            <div class="tools">
                <div id="PartialSection">
                    <div id="LoaderContent" style="height: 100%;">
                        <img src="../../Content/Template/images/finalloader.GIF" style="margin-left: 43%;
                            margin-top: 40%;" />
                    </div>
                </div>
            </div>
        </div>
    </div> 
@section scripts
{
    <script src="../../Content/Template/js/jquery.dataTables.min.js" type="text/javascript"></script>
    <script src="../../Content/Template/js/dataTables.bootstrap.js" type="text/javascript"></script>
    <script src="../../Content/Template/js/select2/select2.min.js" type="text/javascript"></script>
    <script src="../../Content/bootstrap/bootbox.min.js" type="text/javascript"></script>
    <script src="../../Content/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="../../Content/bootstrap/js/bootstrap.js" type="text/javascript"></script>
<script src="../../Content/Template/js/toastr.js" type="text/javascript"></script>
    
   
}
 

 
 